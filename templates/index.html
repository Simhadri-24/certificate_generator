<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Certificate Generator</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f6f7fb; padding:40px; text-align:center; }
    .card { display:inline-block; background:white; padding:28px; border-radius:10px; box-shadow:0 6px 20px rgba(0,0,0,0.08); }
    input[type="text"] { width:360px; padding:12px; font-size:18px; border-radius:8px; border:1px solid #ddd; }
    button { padding:12px 20px; font-size:16px; background:#0b76ff; color:white; border:none; border-radius:8px; cursor:pointer; }
    .note { color:#666; margin-top:12px; font-size:14px; }
    #preview { margin-top:25px; display:none; }
    #preview img { max-width:90%; border:1px solid #ccc; border-radius:8px; }
  </style>
</head>
<body>
  <div class="card">
    <h2>Certificate Generator</h2>
    <form id="certForm">
      <input type="text" name="name" id="name" placeholder="Enter full student name" required /><br/><br/>
      <button type="submit">Preview Certificate</button>
    </form>
    <p class="note">If name alignment looks off, adjust <code>y</code> position in <code>app.py</code>.</p>

    <div id="preview">
      <h3>Preview:</h3>
      <img id="certImage" alt="Certificate Preview" />
      <br/><br/>
      <a id="downloadLink" href="#" download>
        <button type="button">Download Certificate</button>
      </a>
    </div>
  </div>

  <script>
    document.getElementById('certForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      const name = document.getElementById('name').value.trim();
      if (!name) {
        alert("Please enter a name.");
        return;
      }

      const formData = new FormData();
      formData.append("name", name);

      const response = await fetch("/generate", { method: "POST", body: formData });
      const data = await response.json();

      if (data.image) {
        document.getElementById("preview").style.display = "block";
        document.getElementById("certImage").src = data.image;
        document.getElementById("downloadLink").href = data.image;
        document.getElementById("downloadLink").download = `${name}_certificate.jpg`;
      } else {
        alert(data.error || "Error generating certificate.");
      }
    });
  </script>
</body>
</html>
